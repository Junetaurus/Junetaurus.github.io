<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0"><title></title><meta name="author" content="June"><meta name="copyright" content="June"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta property="og:type" content="website">
<meta property="og:title">
<meta property="og:url" content="https://junetaurus.github.io/index.html">
<meta property="og:site_name">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://junetaurus.github.io/img/avatar.png">
<meta property="article:author" content="June">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://junetaurus.github.io/img/avatar.png"><link rel="shortcut icon" href="/img/avatar.png"><link rel="canonical" href="https://junetaurus.github.io/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  }
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '',
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2023-04-04 22:39:10'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">4</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><hr/></div></div><div class="page" id="body-wrap"><header class="full_page" id="page-header" style="background-image: url('/img/background.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title=""><span class="site-name"></span></a></span><div id="menus"><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="site-info"><h1 id="site-title"></h1><div id="site-subtitle"><span id="subtitle"></span></div></div><div id="scroll-down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2023/04/04/App%E5%90%AF%E5%8A%A8%E9%80%9F%E5%BA%A6%E4%BC%98%E5%8C%96%E5%8F%8A%E7%9B%91%E6%8E%A7/" title="App启动速度优化及监控">App启动速度优化及监控</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-04-04T13:56:06.000Z" title="发表于 2023-04-04 21:56:06">2023-04-04</time></span></div><div class="content">App 启动速度优化及监控App启动分为冷启动和热启动，一般优化只针对冷启动

冷启动：App 启动前，其进程不在系统里，需要系统新创建并分配
热启动：App 启动后退出后台，其进程还在系统里

App 冷启动流程：
main 函数执行前
dyld
加载可执行文件
加载动态链接库


runtime
Objc 初始化处理，包括 Objc 相关类的注册，category 注册等
执行 +load 方法，attribute((constructor)) 修饰的函数的调用，C++ 静态初始化




main 函数执行后
首屏初始化配置文件读写
首屏列表数据读写
首屏渲染


首屏渲染完成
其他业务模块初始化等



App 冷启动优化流程：
main 函数执行前
dyld
减少动态库加载
合并动态库


runtime
减少不使用的类或者方法
使用 +initialize 替换 +load 
控制 C++ 全局变量的数量




main 函数执行后
只处理首屏渲染所必需的初始化功能


首屏渲染完成
处理主线程耗时的操作



App 启动速度监控
定时抓取主线程方法调用堆栈，计算每个方 ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2023/04/03/2023%E6%AD%A6%E6%B1%89Flutter%E9%9D%A2%E8%AF%95%E8%AE%B0%E5%BD%95/" title="2023武汉Flutter面试记录">2023武汉Flutter面试记录</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-04-03T10:53:34.000Z" title="发表于 2023-04-03 18:53:34">2023-04-03</time></span></div><div class="content">Dart 是什么，Flutter 为什么选择它var、dynamic、object 的区别const、final 的区别widget 是什么，有几种类型的 widget，分别有什么区别，简单说下其生命周期Hot Restart 和 Hot Reload 的区别async 和 await 一般用于什么情形如何将异步函数作为参数传递箭头函数是什么，一般用于什么场景可选参数和必选参数和原生的交互</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2023/04/01/2023%E6%AD%A6%E6%B1%89iOS%E9%9D%A2%E8%AF%95%E8%AE%B0%E5%BD%95/" title="2023武汉iOS面试记录">2023武汉iOS面试记录</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-04-01T08:28:57.000Z" title="发表于 2023-04-01 16:28:57">2023-04-01</time></span></div><div class="content">copy 和 strong 的区别
copy 拷贝，此处涉及深浅拷贝，也就是是否产生新的对象

strong 强引用，对象引用计数加一


UIView 和 CALayer
UIView 继承 UIResponder 负责响应事件
CALayer 继承 NSObject 负责 UI 绘制
UIView 持有 CALayer 并响应 CALayerDelegate

响应链
事件的传递

触碰屏幕产生 UIEvent 事件并放入 UIApplication 事件队列中，然后在整个视图结构中自上而下分发
UIWindow 接收到事件开始逆序遍历 subviews 查找最优响应视图
涉及 hitTest、pointInside 两个方法


事件的响应

确定最优响应视图，并判断其能否响应事件，如果可以响应则响应链传递终止，反之传递给 nextResponder

如果事件传递至 UIWindow 且无法响应，则事件传递给 UIApplication，如果 UIApplication 也无法响应，最终事件被抛弃




代码片段1234567dispatch_async(dispatch_g ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2023/03/26/iOS%E4%BB%A3%E7%A0%81%E9%9D%A2%E8%AF%95%E9%A2%98/" title="iOS代码面试题">iOS代码面试题</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-03-26T08:34:25.000Z" title="发表于 2023-03-26 16:34:25">2023-03-26</time></span></div><div class="content">123456id __weak obj = nil;&#123;    id __strong obj1 = [[NSObject alloc] init];    obj = obj1; &#125;NSLog(@&quot;%@&quot;,obj);


输出 nil， __weak 修饰符的变量不持有对象，在超出变量作用域时，对象就会被释放并会被置为 nil。


1234567//不使用第三个变量，交换两个变量的值int a = 6;int b = 8;a = a + b;   b = a - b;   a = a - b;  

123456789101112131415161718192021222324252627282930#import &lt;Foundation/Foundation.h&gt;@interface Person : NSObject@end@interface Student : Person@end#import &quot;Person.h&quot;@implementation Person@end@implementation Stu ...</div></div></div><nav id="pagination"><div class="pagination"><span class="page-number current">1</span></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/avatar.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">June</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">4</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/04/04/App%E5%90%AF%E5%8A%A8%E9%80%9F%E5%BA%A6%E4%BC%98%E5%8C%96%E5%8F%8A%E7%9B%91%E6%8E%A7/" title="App启动速度优化及监控">App启动速度优化及监控</a><time datetime="2023-04-04T13:56:06.000Z" title="发表于 2023-04-04 21:56:06">2023-04-04</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/04/03/2023%E6%AD%A6%E6%B1%89Flutter%E9%9D%A2%E8%AF%95%E8%AE%B0%E5%BD%95/" title="2023武汉Flutter面试记录">2023武汉Flutter面试记录</a><time datetime="2023-04-03T10:53:34.000Z" title="发表于 2023-04-03 18:53:34">2023-04-03</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/04/01/2023%E6%AD%A6%E6%B1%89iOS%E9%9D%A2%E8%AF%95%E8%AE%B0%E5%BD%95/" title="2023武汉iOS面试记录">2023武汉iOS面试记录</a><time datetime="2023-04-01T08:28:57.000Z" title="发表于 2023-04-01 16:28:57">2023-04-01</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/03/26/iOS%E4%BB%A3%E7%A0%81%E9%9D%A2%E8%AF%95%E9%A2%98/" title="iOS代码面试题">iOS代码面试题</a><time datetime="2023-03-26T08:34:25.000Z" title="发表于 2023-03-26 16:34:25">2023-03-26</time></div></div></div></div><div class="card-widget card-archives"><div class="item-headline"><i class="fas fa-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/04/"><span class="card-archive-list-date">四月 2023</span><span class="card-archive-list-count">3</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/03/"><span class="card-archive-list-date">三月 2023</span><span class="card-archive-list-count">1</span></a></li></ul></div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>网站资讯</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">文章数目 :</div><div class="item-count">4</div></div><div class="webinfo-item"><div class="item-name">本站访客数 :</div><div class="item-count" id="busuanzi_value_site_uv"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">本站总访问量 :</div><div class="item-count" id="busuanzi_value_site_pv"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">最后更新时间 :</div><div class="item-count" id="last-push-date" data-lastPushDate="2023-04-04T14:39:10.385Z"><i class="fa-solid fa-spinner fa-spin"></i></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By June</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><div class="js-pjax"><script>window.typedJSFn = {
  init: (str) => {
    window.typed = new Typed('#subtitle', Object.assign({
      strings: str,
      startDelay: 300,
      typeSpeed: 150,
      loop: true,
      backSpeed: 50,
    }, null))
  },
  run: (subtitleType) => {
    if (true) {
      if (typeof Typed === 'function') {
        subtitleType()
      } else {
        getScript('https://cdn.jsdelivr.net/npm/typed.js/lib/typed.min.js').then(subtitleType)
      }
    } else {
      subtitleType()
    }
  }
}
</script><script>function subtitleType () {
  if (true) {
    typedJSFn.init(["凡是过往，皆为序章。"])
  } else {
    document.getElementById("subtitle").innerHTML = '凡是过往，皆为序章。'
  }
}
typedJSFn.run(subtitleType)</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>